bp <- read.table("F:/Cheko recruitment age and longevity paper/Plot Recruiting age - longevity/RecAge and longevity.csv",sep=",",header=TRUE,as.is=TRUE)
bp <- read.table("F:/Cheko recruitment age and longevity paper/Plot Recruiting age - longevity/input/RecAge and longevity.csv",sep=",",header=TRUE,as.is=TRUE)
names(bp)
s<-bp[,4:29]
s$extracol <- 1
s$extracol2 <-1
names(s)
s2 <- s[3:5, c(27,1:22,28)]
names(s2)
count.zeroes <- apply (s2,1, function(x) diff(which(x==1))-1)
s2
count.zeroes
rnorm(100,10, sd=1)
x<-rnorm(100,10, sd=1)
hist(x)
sd(x)
rnorm(1,10,sd=1)
rnorm(1,10,sd=1)
rnorm(1,10,sd=1)
rnorm(1,10,sd=1)
rnorm(1,10,sd=1)
rnorm(1,10,sd=1)
asr<- c(0.02, 0.05, 0.09)
osr<- c(0.13, 0.21, 0.31)
wilcox.test(asr,osr)
help(wilcox.test)
t.test(asr, osr, paired=TRUE)
1.5756-1.5373
239.47-266.
239.47-267.37
2790/239.47
3.83/1.5756
m<-c(46)
f<-c(27)
mf<-rbind(m,f)
chisq.test(mf, p=c(1/2))
chisq.test(mf, p=c(1/2,1/2))
help(t.test)
m/f
m/f+m
m/(f+m)
t.test(m/(f+m), mu=0.5, paired=F)
binomial test
help(binom.test)
binom.test(46,46+27, p=0.5)
binom.test(38,38+32, p=0.5)
binom.test(25,25+21, p=0.5)
chisq.test(mf, p=c(1/2,1/2))
binom.test(46,46+27, p=0.5)
m<-c(46,38,25)
f<-c(27,32,21)
mf<-rbind(m,f)
chisq.test(mf, p=c(1/2,1/2,1/2))
m<-c(46)
f<-c(27)
mf<-rbind(m,f)
chisq.test(mf, p=c(1/2,1/2))
pf(23.45,1,19)
pf(23.45,1,19, lower.tail=F)
pf(23.45,1,17, lower.tail=F)
pf(0.67,1,18, lower.tail=F)
??pf
help(pf)
vector)=
vector)=
x<-c(1:20)
x
y<-10
y
z<-1:20
z
as.numeric(x)
as.logical(x)
as.complex(x)
m<-matrix(1:6, nrow=2, ncol=3)
m
m
clear.function(x)
remove(x)
remove(y)
remove(z)
x<-1:3
y<-10:12
cbind(x,y)
remove(x)
remove(y)
x<-factor(c("yes,"yes","no","yes","no""))
x
x<-factor(c("yes , "yes" , "no" , "yes" , "no"))
x<-factor(c("yes" , "yes" , "no" , "yes" , "no"))
x
table(x)
unclass(x)
levels=c("yes","no")
x
levels=c("yes","no"))
x<-factor(c("yes,"yes","no","yes","no"), levels=c("yes","no"))
x<-factor(c("yes","yes","no","yes","no"), levels=c("yes","no"))
x
z<-c(1,2,NA,3)
Z
z
is.na(x)
is.na(z)
is.nan(z)
n<-data.frame(foo=1:4,bar=c(T,T,F,F))
N
n
nrow(x)
nrow(n)
ncolumn(n)
ncol(n)
x
z
n
remove(x)
names(x)
x<-1:3
names(x)
names(x)<-c("hello","bye","yes")
x
names(x)
u<-list(a=1,b=2,c=3)
u
remove(m)
m<-matrix(1:4, nrow=2, ncol=2)
dimnames(m)<-list(c("a","b), c("c","d"))
dimnames(m)<-list(c("a","b"), c("c","d"))
m
z[1:4]
z
x
x[1:4]
o<-x>"a"
o
remove(n)
remove(x)
remove(o)
remove(z)
remove(m)
remove(n)
remove(n)remove(u)
remove(n), remove(u)
remove(u)
x<-matrix(1:6, 2, 3)
x[1,2]
x[1,3]
x[1,1]
x[1,2]
x[1, ]
x[,2]
remove(x)
x[[name]]
x<-list(food=10,drink=5,wish="nein")
name<-"food"
x[[name]]
x$name
remove(x)
remove(name)
remove(levels)
x<-list(a=list(10,12,14),=c(2.45, 5.64))
x<-list(a= list(10,12,14),b =c(2.45, 5.64))
x[[c(1,3)]]
x[[c(2,2)]]
x[[c(2,3)]]
x<-list(quadratic = 1:20)
x$q
x[["q"]]
x[["q", exact = F]]
remove(x)
x<-c(1,2,3,NA,5,6,NA)
bad<-is.na(x)
x[!bad]
x(!bad)
y<-c("a","b",NA,"d",NA,8,7)
good<-complete.case(c,y)
good<-complete.cases(c,y)
good<-complete.cases(x,y)
good
x[good]
y[good]
load("F:/Plovers/3rd Chapter/input/Madagascar/.RData")
bfa[is.na(bfa$parent),]
table(sex$sex, na.omit=F)
help(table)
table(sex$sex, useNA=]"always")
table(sex$sex, useNA="always")
sex<-sex[!is.na(sex$sex),]
bfa$mol_sex.p1<-NA
bfa$mol_sex.p2<-NA
#a) add mol sex to individuals with rings FH...
letters<-"^[FH0-9]*$"
for(i in 1:length(bfa$year)){ #modification for MAD, search for rings of individuals with code but no ring
print(i)
if(!is.na(bfa$parent1[i]) & grepl(pattern=letters, bfa$parent1[i], perl=T)){
bfa$mol_sex.p1[i] <- sex$sex[match(bfa$parent1[i], sex$ring)]
}
if(!is.na(bfa$parent2[i]) & grepl(pattern=letters, bfa$parent2[i], perl=T)){
bfa$mol_sex.p2[i] <- sex$sex[match(bfa$parent2[i], sex$ring)]
}
}
#b) add mol sex to individuals with no rings
bfa$sp.new.code.p1 <- paste(bfa$species, bfa$new.code.p1, sep="-")
bfa$sp.new.code.p2 <- paste(bfa$species, bfa$new.code.p2, sep="-")
sex$sp.code <- paste(sex$species, sex$ring, sep="-")
for(i in 1:length(bfa$year)){ #modification for MAD, search for rings of individuals with code but no ring
if(is.na(bfa$mol_sex.p1[i]) & !is.na(bfa$new.code.p1[i])){
bfa$mol_sex.p1[i] <- sex$sex[match(bfa$sp.new.code.p1[i], sex$sp.code)]
print(i)
}
if(is.na(bfa$mol_sex.p2[i]) & !is.na(bfa$new.code.p2[i])){
bfa$mol_sex.p2[i] <- sex$sex[match(bfa$sp.new.code.p2[i], sex$sp.code)]
}
}
#---debug 2.--------------------------------------------------------
head(bfa)
str(bfa[is.na(bfa$mol_sex.p1),]) #372 NAs in mol_sex.p1, after sp.code (b) 328 NAs
str(bfa[is.na(bfa$mol_sex.p2),]) #822 NAs in mol_sex.p2, after sp.code (b) 815 NAs
str(bfa[is.na(bfa$mol_sex.p2) & is.na(bfa$mol_sex.p1),]) #334 NAs in both molp1 and molp2, after sp.code (b) 290 NAs
#--------------------------------------------------
#3. Create parent column
#Both parents are present
for(i in 1:length(bfa$year)){
if(!is.na(bfa$parent1[i]) & !is.na(bfa$parent2[i])|
!is.na(bfa$mol_sex.p1[i]) & !is.na(bfa$mol_sex.p2[i])){
bfa$parent[i] <- 4
}
}
bfa[bfa$parent %in% "4",]
bfa[!bfa$parent %in% "4",]
table(bfa$mol_sex.p1)
table(bfa$mol_sex.p2)
#One parent present
for(i in 1:length(bfa$year)){
print(i)
if(!is.na(bfa$mol_sex.p1[i]) & is.na(bfa$mol_sex.p2[i])){
if(bfa$mol_sex.p1[i] %in% "M"){
bfa$parent[i] <- 3
}else{
if(bfa$mol_sex.p1[i] %in% "F"){
bfa$parent[i] <- 2
}
}
}else{
if(!is.na(bfa$mol_sex.p2[i]) & is.na(bfa$mol_sex.p1[i])){
if(bfa$mol_sex.p2[i] %in% "M"){
bfa$parent[i] <- 3
}else{
if(bfa$mol_sex.p2[i] %in% "F"){
bfa$parent[i] <- 2
}
}
}
}
}
str(bfa[is.na(bfa$mol_sex.p1),]) #372 NAs in mol_sex.p1, after sp.code (b) 328 NAs
str(bfa[is.na(bfa$mol_sex.p2),]) #822 NAs in mol_sex.p2, after sp.code (b) 815 NAs
str(bfa[is.na(bfa$mol_sex.p2) & is.na(bfa$mol_sex.p1),]) #334 NAs in both molp1 and molp2, after sp.code (b) 290 NAs
for(i in 1:length(bfa$year)){
if(!is.na(bfa$parent1[i]) & !is.na(bfa$parent2[i])|
!is.na(bfa$mol_sex.p1[i]) & !is.na(bfa$mol_sex.p2[i])){
bfa$parent[i] <- 4
}
}
bfa[bfa$parent %in% "4",]
bfa[!bfa$parent %in% "4",]
table(bfa$mol_sex.p1)
table(bfa$mol_sex.p2)
#One parent present
for(i in 1:length(bfa$year)){
print(i)
if(!is.na(bfa$mol_sex.p1[i]) & is.na(bfa$mol_sex.p2[i])){
if(bfa$mol_sex.p1[i] %in% "M"){
bfa$parent[i] <- 3
}else{
if(bfa$mol_sex.p1[i] %in% "F"){
bfa$parent[i] <- 2
}
}
}else{
if(!is.na(bfa$mol_sex.p2[i]) & is.na(bfa$mol_sex.p1[i])){
if(bfa$mol_sex.p2[i] %in% "M"){
bfa$parent[i] <- 3
}else{
if(bfa$mol_sex.p2[i] %in% "F"){
bfa$parent[i] <- 2
}
}
}
}
}
#---------------------debug
bfa[is.na(bfa$parent1) & !is.na(bfa$parent2),]
head(bfa)
table(bfa$year)
bfa[is.na(bfa$parent),]
table(bfa$parents, useNA="always")
table(bfa$parent, useNA="always")
bfa[is.na(bfa$parent),c("parent1","parent2","mol_sex.p1", "mol_sex.p2", "parent")]
bfa[is.na(bfa$parent),c("parent1","parent2","new.code1","mol_sex.p1", "mol_sex.p2", "parent")]
head(bfa)
bfa[is.na(bfa$parent),c("parent1","parent2","new.code.p1","new.code.p2","mol_sex.p1", "mol_sex.p2", "parent")]
#--------------------------
bfa[is.na(bfa$parent),c("parent1","parent2","new.code.p1","new.code.p2","mol_sex.p1", "mol_sex.p2", "parent")]
head(bfa)
bfa$no_chicks <- apply(bfa[,c("chick1","chick2","chick3")], 1 function(x)
length (which(!is.na(x))))
bfa$no_chicks <- apply(bfa[,c("chick1","chick2","chick3")], 1 function(x)
length
bfa$no_chicks <- apply(bfa[,c("chick1","chick2","chick3")], 1 function(x) length(which(!is.na(x))))
#----------------------WRITE STD FILE
bfa$no_chicks <- apply(bfa[,c("chick1","chick2","chick3")], 1 function(x) length(which(!is.na(x))))
bfa$no_chicks <- apply(bfa[,c("chick1","chick2","chick3")], 1, function(x) length(which(!is.na(x))))
bfa$no_chicks
head(bfa)
setwd("F:/Plovers/3rd Chapter/Exploratory_results/output")
csvfiles <- list.files(path = ".", pattern='*\\.csv$', all.files=TRUE)
csvfiles
import.list <- lapply(csvfiles, read.csv, header = TRUE, as.is=TRUE, na.strings=c("NA"," ",""))
working.list <- import.list[c(5,4)]#bs_data_per_indiv.csv
working.list <- import.list[c(4,5)]#bs_data_per_indiv.csv
names(working.list) <- c("season","indiv")
attach(working.list)
library(plyr)
str(indiv, list.len=300)
cols<-c(122,124)
indiv[,cols]<-apply(indiv[,cols], 2, function(x) as.Date(x, "%Y-%m-%d"))
indiv$pop.year <- paste(indiv$population, indiv$year, sep="-")
indiv<-ddply(indiv, c("pop.year"), transform, bs.start.std= scale(bs.start))
indiv<-ddply(indiv, c("pop.year"), transform, bs.end.std=scale(bs.end))
indiv<-ddply(indiv, c("pop.year"), transform, bs.length.std=scale(bs.length))
indiv$pop.sp.sex<-ifelse(indiv$population %in% "Tuzla",
paste(indiv$population, indiv$species, indiv$field_sex_focal, sep="-"),
paste(indiv$population, indiv$species, indiv$mol_sex_focal, sep="-"))
indiv$sex<-ifelse(indiv$population %in% "Tuzla", indiv$field_sex_focal, indiv$mol_sex_focal)
indiv$pop.sp.field_sex<-paste(indiv$population, indiv$species, indiv$field_sex_focal, sep="-")
indiv$pop.sp.year<-paste(indiv$pop.sp, indiv$year, sep="-")
unique(indiv$pop.sp.year)
indiv$season.length <- season$breedingseasonlength[match(indiv$pop.sp.year, season$pop.sp.year)]
indiv$season.length
indiv[indiv$bs.length > indiv$season.length,]
indiv$corrected.bs.length <- ifelse(indiv$bs.length > indiv$season.length, indiv$season.length, indiv$bs.length)
indiv<-ddply(indiv, c("pop.year"), transform, corrected.bs.length.std=scale(corrected.bs.length))
hist(indiv$corrected.bs.length.std)
qqnorm(indiv$corrected.bs.length.std)
qqline(indiv$corrected.bs.length.std,lty=2)
shapiro.test(indiv$corrected.bs.length.std)
ks.test(indiv$corrected.bs.length.std, pnorm)
males.mol<-indiv[grep(indiv$pop.sp.sex, pattern="M$"),]
females.mol<-indiv[grep(indiv$pop.sp.sex, pattern="F$"),]
both<-rbind(males.mol, females.mol)
pairs(~ bs.start.std + bs.end.std + bs.length+total.nests.peryear, data=females.mol, panel=panel.smooth)
lm.1<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear + sex + pop.sp:sex, data=both)
summary(lm.1)
summary(lm.1)
lm.m<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear, data=males.mol)
summary(lm.m)
lm.m<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear+year, data=males.mol)
summary(lm.m)
both$year<- as.factor(both$year)
lm.m<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear+year, data=males.mol)
summary(lm.m)
both$year
indiv$year<- as.factor(indiv$year)
males.mol<-indiv[grep(indiv$pop.sp.sex, pattern="M$"),]
females.mol<-indiv[grep(indiv$pop.sp.sex, pattern="F$"),]
both<-rbind(males.mol, females.mol)
lm.m<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear+year, data=males.mol)
summary(lm.m)
indiv$year
lm.1<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear + sex + pop.sp:sex+year, data=both)
summary(lm.1)
lm.m<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear+year+season, data=males.mol)
lm.m<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear+year+season.length, data=males.mol)
summary(lm.m)
lm.m<-lm(corrected.bs.length.std~pop.sp + bs.end.std + total.nests.peryear+year+season.length, data=males.mol)
summary(lm.m)
lm.m<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear+year+season.length, data=males.mol)
summary(lm.m)
help(alias)
alias(lm.m)
cor(lm.m)
library(HH)
vif(lm.m)
install.packages("HH")
library(HH)
vif(lm.m)
lm.m<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear+year, data=males.mol)
vif(lm.m)
lm.m<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear+year, data=males.mol)
summary(lm.m)
lm.m1<-update(lm.m, .~.-year,.)
anova(lm.m1, lm.m)
lm.m2<-update(lm.m1,.~.-pop.sp,.)
anova(lm.m1,lm.m2)
anova(lm.m1,lm.m2)
summary(lm.m1)
lm.m3<-update(lm.m1, .~.-bs.start.std,.)
anova(lm.m1, lm.m3)
lm.m4<-update(lm.m1, .~.-total.nests.peryear,.)
anova(lm.m1,lm.m4)
anova(lm.m1,lm.m4)[2]
anova(lm.m1,lm.m4)[5]
anova(lm.m1,lm.m4)[6]
anova(lm.m1,lm.m4)[[6]]
anova(lm.m1,lm.m4)[[7]]
anova(lm.m1,lm.m4)[[6]]
anova(lm.m1,lm.m4)[[6]][1]
anova(lm.m1,lm.m4)[[6]][2]
print(levels(males.mol$pop.sp))
males.mol$pop.sp
indiv$pop.sp<-as.factor(indiv$pop.sp)
males.mol<-indiv[grep(indiv$pop.sp.sex, pattern="M$"),]
females.mol<-indiv[grep(indiv$pop.sp.sex, pattern="F$"),]
both<-rbind(males.mol, females.mol)
print(levels(males.mol$pop.sp))
indiv$ms <- ifelse(indiv$pop.sp %in% c("Ceuta-SP", "Tuzla-KP", "Madagascar-KiP"), "Pol", "Mon")
males.mol<-indiv[grep(indiv$pop.sp.sex, pattern="M$"),]
females.mol<-indiv[grep(indiv$pop.sp.sex, pattern="F$"),]
both<-rbind(males.mol, females.mol)
lm.1<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear + sex + pop.sp:sex+year + ms, data=both)
summary(lm.1)
lm.m<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear+year+ms, data=males.mol)
summary(lm.m)
lm.m<-lm(corrected.bs.length.std~ms, data=males.mol)
summary(lm.m)
lm.m<-lm(corrected.bs.length.std~ms+pop.sp + bs.start.std + total.nests.peryear+year, data=males.mol)
summary(lm.m)
library(HH)
vif(lm.m)
lm.m1<-update(lm.m, .~.-year,.)
anova(lm.m1, lm.m)
lm.m2<-update(lm.m1,.~.-pop.sp,.)
anova(lm.m1,lm.m2)
summary(lm.m1)
lm.1<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear + sex + pop.sp:sex+year + ms, data=both)
summary(lm.1)
lm.1<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear + sex +year + ms, data=both)
summary(lm.1)
lm.1<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear + sex +year + ms + ms:sex, data=both)
summary(lm.1)
vif(lm.1)
lm.m<-lm(corrected.bs.length.std~ms+pop.sp + bs.start.std + total.nests.peryear+year-1, data=males.mol)
summary(lm.m)
lm.m<-lm(corrected.bs.length.std~ms+pop.sp + bs.start.std + total.nests.peryear+year, data=males.mol)
summary(lm.m)
print(levels(males.mol$year))
lm.m1<-update(lm.m, .~.-year,.)
anova(lm.m1, lm.m)
summary(lm.m1)
lm.m<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear+year, data=males.mol)
summary(lm.m)
indiv$ms<-as.factor(indiv$ms)
lm.1<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear + sex +year + ms + ms:sex, data=both)
summary(lm.1)
lm.m<-lm(corrected.bs.length.std~ms+pop.sp + bs.start.std + total.nests.peryear+year, data=males.mol)
summary(lm.m)
lm.m1<-update(lm.m, .~.-year,.)
summary(lm.m1)
lm.m1<-update(lm.m, .~.-year-1,.)
summary(lm.m1)
lm.m<-lm(corrected.bs.length.std~ms*pop.sp + bs.start.std + total.nests.peryear+year, data=males.mol)
summary(lm.m)
lm.1<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear + sex +year + ms + ms:sex, data=both)
summary(lm.1)
lm.1<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear + sex +year + ms + ms:sex+pop.sp:sex, data=both)
summary(lm.1)
lm.1<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear + sex  ms + ms:sex+pop.sp:sex, data=both)
summary(lm.1)
lm.1<-lm(corrected.bs.length.std~pop.sp + bs.start.std + total.nests.peryear + sex+  ms + ms:sex+pop.sp:sex, data=both)
summary(lm.1)
